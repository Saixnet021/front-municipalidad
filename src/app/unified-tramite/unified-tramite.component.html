<div class="container mx-auto px-4 py-8 animate-fade-in max-w-3xl">
  <div class="mb-8 text-center">
    <h1 class="text-3xl font-display font-bold text-slate-800">Nuevo Trámite</h1>
    <p class="text-slate-500 mt-2">Selecciona el tipo de trámite y completa la información.</p>
  </div>

  <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 md:p-8">
    <form [formGroup]="tramiteForm" (ngSubmit)="onSubmit()" class="space-y-6">
      
      <!-- Tipo de Trámite -->
      <div>
        <label class="block text-sm font-medium text-slate-700 mb-1">Tipo de Trámite</label>
        <select formControlName="tipo" class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
          <option value="">Seleccione una opción...</option>
          <option *ngFor="let tipo of tiposTramite" [value]="tipo.id">{{ tipo.nombre }}</option>
        </select>
      </div>

      <!-- Usuario (Common) -->
      <div>
        <label class="block text-sm font-medium text-slate-700 mb-1">Solicitante (Usuario)</label>
        <input type="text" formControlName="usuario" class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all" placeholder="Nombre completo">
      </div>

      <!-- Mesa de Partes Fields -->
      <div *ngIf="tramiteForm.get('tipo')?.value === 'mesa-de-partes'" class="space-y-4 animate-fade-in">
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-1">Asunto</label>
          <input type="text" formControlName="asunto" class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
        </div>
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-1">Descripción</label>
          <textarea formControlName="descripcion" rows="4" class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all resize-none"></textarea>
        </div>
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-1">Archivo Adjunto</label>
          <input type="file" (change)="onFileSelect($event)" class="w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
        </div>
      </div>

      <!-- Constancia Fields -->
      <div *ngIf="tramiteForm.get('tipo')?.value === 'constancia'" class="space-y-4 animate-fade-in">
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-1">Dirección</label>
          <input type="text" formControlName="direccion" class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
        </div>
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-1">Tiempo de Residencia (meses)</label>
          <input type="number" formControlName="tiempoResidencia" class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
        </div>
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-1">Recibo de Servicio (Adjunto)</label>
          <input type="file" (change)="onFileSelect($event)" class="w-full text-sm text-slate-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
        </div>
      </div>

      <!-- Licencia Fields -->
      <div *ngIf="tramiteForm.get('tipo')?.value === 'licencia'" class="space-y-4 animate-fade-in">
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-1">Nombre del Negocio</label>
          <input type="text" formControlName="nombreNegocio" class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
        </div>
        <div>
          <label class="block text-sm font-medium text-slate-700 mb-1">Giro</label>
          <input type="text" formControlName="giro" class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-1">Área (m²)</label>
            <input type="number" formControlName="area" class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
          </div>
          <div>
            <label class="block text-sm font-medium text-slate-700 mb-1">Zonificación</label>
            <select formControlName="zonificacion" class="w-full px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
              <option value="">Seleccione...</option>
              <option value="COMERCIAL">Comercial</option>
              <option value="RESIDENCIAL">Residencial</option>
              <option value="INDUSTRIAL">Industrial</option>
            </select>
          </div>
        </div>
      </div>

      <div *ngIf="error" class="p-3 bg-red-50 text-red-700 rounded-lg text-sm border border-red-200">
        {{ error }}
      </div>

      <button type="submit" [disabled]="tramiteForm.invalid || enviando" class="w-full bg-blue-600 text-white py-3 rounded-lg font-semibold hover:bg-blue-700 transition-colors flex items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-md hover:shadow-lg">
        <span *ngIf="!enviando">Registrar Trámite</span>
        <span *ngIf="enviando">Procesando...</span>
      </button>

    </form>
  </div>
</div>

<!-- Success Modal -->
<div *ngIf="mostrarModal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4 animate-fade-in">
  <div class="bg-white rounded-xl shadow-2xl max-w-md w-full p-6">
    <div class="text-center mb-6">
      <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
        <svg class="w-8 h-8 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
        </svg>
      </div>
      <h3 class="text-xl font-bold text-slate-800 mb-2">¡Trámite Registrado!</h3>
      <p class="text-slate-600">Su solicitud ha sido enviada correctamente.</p>
    </div>

    <div class="bg-slate-50 rounded-lg p-4 mb-6 text-center border border-slate-200">
      <p class="text-xs text-slate-500 uppercase tracking-wide font-semibold mb-1">Número de Expediente</p>
      <p class="text-2xl font-bold text-blue-600 font-mono">{{ expedienteGenerado }}</p>
    </div>

    <button (click)="cerrarModal()" class="w-full bg-blue-600 text-white py-2.5 rounded-lg font-semibold hover:bg-blue-700 transition-colors">
      Aceptar
    </button>
  </div>
</div>
